

configurations {
    querydslapt
}

sourceSets {
    main {
        java {
            srcDir file("metamodels")
        }
    }
}

task querymodels(type: JavaCompile, group: 'build') {
    doFirst {
        delete file("metamodels");
        file("metamodels").mkdirs();
    }

    classpath = configurations.compile + configurations.querydslapt
    destinationDir = file("metamodels")

    source = sourceSets.main.java
    options.compilerArgs = [
            "-proc:only",
            "-processor", "com.querydsl.apt.jpa.JPAAnnotationProcessor",
            "-s", file("metamodels")
    ]
}

//代码编译前，自动执行querymodels
compileJava.dependsOn querymodels

dependencies {
    compile project(":common-web")
    compile project(":common-db")
    // 引入knife4j作为接口的呈现方式
//    compile group: 'com.github.xiaoymin', name: 'knife4j-spring-ui', version: '2.0.2'

    querydslapt("com.querydsl:querydsl-apt:4.2.1")
}

